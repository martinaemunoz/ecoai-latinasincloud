{% extends "base.html" %}

{% block content %}
<section class="results-section">
    <div class="results-container">
        <a href="{{ url_for('index') }}" class="back-link">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" width="20" height="20">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Volver a inicio
        </a>

        {% if resultado is string %}
            <!-- Error State -->
            <div class="error-container">
                <div class="error-icon">‚ö†Ô∏è</div>
                <h2>Oops, algo sali√≥ mal</h2>
                <p class="error-message">{{ resultado }}</p>
                <a href="{{ url_for('index') }}" class="btn btn-primary">Intentar de nuevo</a>
            </div>

        {% elif resultado is mapping %}
            <!-- Success State -->
            <div class="success-container">
                <h2>Tu Impacto Ambiental</h2>
                
                <!-- Results Grid -->
                <div class="results-grid">
                    <!-- Water Impact Card -->
                    <div class="result-card water-card">
                        <div class="card-header">
                            <span class="metric-icon">üíß</span>
                            <h3>Consumo de Agua</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric-value">{{ resultado.agua }} <span class="metric-unit">L</span></div>
                            <div class="metric-equivalence">{{ resultado.eq_agua }}</div>
                        </div>
                    </div>

                    <!-- Energy Impact Card -->
                    <div class="result-card energy-card">
                        <div class="card-header">
                            <span class="metric-icon">‚ö°</span>
                            <h3>Consumo de Energ√≠a</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric-value">{{ resultado.energia }} <span class="metric-unit">kWh</span></div>
                            <div class="metric-equivalence">{{ resultado.eq_energia }}</div>
                        </div>
                    </div>

                    <!-- Carbon Impact Card -->
                    <div class="result-card carbon-card">
                        <div class="card-header">
                            <span class="metric-icon">üåç</span>
                            <h3>Emisiones de CO‚ÇÇ</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric-value">{{ resultado.co2 }} <span class="metric-unit">g</span></div>
                            <div class="metric-equivalence">{{ resultado.eq_co2 }}</div>
                        </div>
                    </div>
                </div>

                <!-- Summary Card -->
                <div class="summary-card">
                    <h3>Resumen de tu Consulta</h3>
                    <div class="summary-details">
                        <div class="summary-row">
                            <span class="summary-label">Modelo:</span>
                            <span class="summary-value">{{ resultado.modelo }}</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Tipo de Consulta:</span>
                            <span class="summary-value">{{ resultado.tipo_consulta|capitalize }}</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Cantidad:</span>
                            <span class="summary-value">{{ resultado.cantidad_formateada }}</span>
                        </div>
                    </div>
                </div>

                <!-- Call to Action -->
                <div class="cta-section">
                    <h3>¬øQu√© sigue?</h3>
                    <div class="cta-buttons">
                        <a href="{{ url_for('index') }}" class="btn btn-primary">Calcular de nuevo</a>
                        <a href="#" class="btn btn-secondary" id="compareBtn">Ver comparativa</a>
                    </div>
                </div>
            </div>

        {% else %}
            <!-- No Results State -->
            <div class="empty-state">
                <div class="empty-icon">üìä</div>
                <h2>Sin resultados</h2>
                <p>No hay datos disponibles para mostrar. Por favor, regresa e intenta de nuevo.</p>
                <a href="{{ url_for('index') }}" class="btn btn-primary">Volver al inicio</a>
            </div>

        {% endif %}
    </div>
</section>

<!-- Comparison Modal (Hidden by default) -->
<div id="compareModal" class="modal hidden">
    <div class="modal-content">
        <button class="modal-close" id="closeModal">&times;</button>
        <h2>Comparativa de Modelos</h2>
        <p>Aqu√≠ se mostrar√°n los gr√°ficos de comparativa entre modelos (implementado por Clara)</p>
        <div class="placeholder-charts">
            <div class="placeholder">Gr√°fico 1: Agua por modelo</div>
            <div class="placeholder">Gr√°fico 2: Energ√≠a por modelo</div>
            <div class="placeholder">Gr√°fico 3: CO‚ÇÇ por modelo</div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const compareBtn = document.getElementById('compareBtn');
    const compareModal = document.getElementById('compareModal');
    const closeModal = document.getElementById('closeModal');

    if (compareBtn) {
        compareBtn.addEventListener('click', function(e) {
            e.preventDefault();
            compareModal.classList.remove('hidden');
        });
    }

    if (closeModal) {
        closeModal.addEventListener('click', function() {
            compareModal.classList.add('hidden');
        });
    }

    if (compareModal) {
        compareModal.addEventListener('click', function(e) {
            if (e.target === compareModal) {
                compareModal.classList.add('hidden');
            }
        });
    }
});
</script>
{% endblock %}